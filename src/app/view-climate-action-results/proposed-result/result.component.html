<div class="container pl-20 pr-20">
  <div id="content" #content>
    <div id="download-content">
    <div class="mb-12">
      <h4 class="mt-4" #name>Assessment of {{title}} Specific Climate Action - {{assement.project.climateActionName}}
      </h4>
    </div>

    <br>
    <div class="card">
      <div class="p-grid p-fluid col-sm-12">
        <!-- <div class="p-2">
            <h6>Contact Details</h6>
          </div> -->
        <div class="row p-2">
          <div class="row p-2">
            <div class="col-12 col-md-3">
              <div class="p-field">
                <label for="ndc">Aggregated Actions - </label>

              </div>
            </div>
            <div class="col-12 col-md-7">
              <div class="p-field">
                <label for="ndc">{{assement.ndc.name}} </label>

              </div>
            </div>
          </div>

          <div class="row p-2">
            <div class="col-12 col-md-3">
              <div class="p-field">
                <label for="subNdc">Action Areas - </label>

              </div>
            </div>
            <div class="col-12 col-md-7">
              <div class="p-field">
                <label for="subNdc">{{assement.subNdc.name}} </label>

              </div>
            </div>

          </div>




          <div class="row p-2">
            <div class="col-12 col-md-3">
              <div class="p-field">
                <!-- <label for="objective">The objective of assessment - {{objectiveName.join(", ")}} </label> -->
                <label for="objective">The Objective of Assessment -</label>

              </div>
            </div>
            <div class="col-12 col-md-7">
              <div class="p-field">
                <!-- <label for="objective">The objective of assessment - {{objectiveName.join(", ")}} </label> -->
                <label for="objective">{{objectiveName.join(",")}} </label>

              </div>
            </div>

          </div>


          <div class="row p-2">
            <div class="col-12 col-md-3">
              <div class="p-field">
                <label for="bscenarioyr">Baseline Year - </label>

              </div>
            </div>
            <div class="col-12 col-md-7">
              <div class="p-field">
                <label for="bscenarioyr">{{assement.baseYear}} </label>

              </div>
            </div>

          </div>


          <!-- </div>

          <div class="row p-2"> -->

          <div class="row p-2">
            <div class="col-12 col-md-3">
              <div class="p-field">
                <label for="pscenarioyr">Project Year -</label>

              </div>
            </div>
            <div class="col-12 col-md-7">
              <div class="p-field">
                <label for="pscenarioyr">{{assessmentYr}} </label>

              </div>
            </div>

          </div>



          <div class="row p-2">
            <div class="col-12 col-md-3">
              <div class="p-field">
                <label for="approach">Assessment Approach -</label>

              </div>
            </div>
            <div class="col-12 col-md-7">
              <div class="p-field">
                <label for="approach">{{assement.assessmentType}} </label>

              </div>
            </div>
          </div>


          <div class="row p-2">

            <div class="col-12 col-md-3">
              <div class="p-field">
                <label for="methodology">Assessment Methodology -</label>

              </div>
            </div>
            <div class="col-12 col-md-7">
              <div class="p-field">
                <label for="methodology">{{assement.methodology.displayName}} </label>

              </div>
            </div>
          </div>
          <!-- </div>
          <div class="row p-2"> -->

        </div>
      </div>
    </div>



    <!-- baseline start-->

    <div class="card">
      <div class="p-grid p-fluid col-sm-12">
        <div class="p-2">
          <h6>Baseline</h6>
        </div>
        <div class="row p-2">
          <div class="col-12 col-md-12">
            <div class="p-field">
              <label for="bScenario">Baseline Scenario - {{assement.baselineScenario}} </label>

            </div>
          </div>



          <!-- <div> {{baseParameter|json}} </div> -->
          <div class="row p-2">
            <p-table [value]="baseParameter">
              <ng-template pTemplate="header">
                <tr>
                  <th>
                    <div class="col-sm-2">
                    </div>
                  </th>
                  <th>Parameter</th>
                  <th>Value</th>
                  <th>Unit</th>
                  <!-- unit from json to be added -->
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-bvalues>
                <tr>
                  <td style="text-align: center">

                  </td>
                  <td>{{ bvalues.name }}</td>
                  <td>{{ bvalues.value }}</td>
                  <td>{{ bvalues.uomDataRequest }}</td>
                  <!-- unit from json to be added -->
                </tr>
              </ng-template>
            </p-table>

            <div *ngIf="baselineEmission != null" class="row p-2">
              <div class="col-12 col-md-6">
                <div class="p-field">
                  <label for="baselineEmi"><b> Baseline Emission : {{baselineEmission}} tCO₂e</b></label>

                </div>
              </div>
            </div>
          </div>

        </div>


      </div>
    </div>


    <!-- baseline End-->


    <!-- Project start-->

    <div class="card">
      <div class="p-grid p-fluid col-sm-12">
        <div class="p-2">
          <h6>Project</h6>
        </div>
        <div class="row p-2">
          <div class="col-12 col-md-12">
            <div class="p-field">
              <label for="pScenario">Project Scenario -  {{assement.projectScenario}}</label>

            </div>
          </div>



          <!-- <div> {{proParameter|json}} </div> -->
          <div class="row p-2">
            <p-table [value]="proParameter">
              <ng-template pTemplate="header">
                <tr>
                  <th>
                    <div class="col-sm-2">
                    </div>
                  </th>
                  <th>Parameter</th>
                  <th>Value</th>
                  <th>Unit</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-presult>
                <tr>
                  <td style="text-align: center">

                  </td>
                  <td>{{ presult.name }}</td>
                  <td>{{ presult.value }}</td>
                  <td>{{ presult.uomDataRequest }}</td>
                  <!-- unit from json to be added -->
                </tr>
              </ng-template>
            </p-table>

            <div *ngIf="projectEmission != null " class="row p-2">
              <div class="col-12 col-md-6">
                <div class="p-field">
                  <label for="contatname"><b> Project Emission :  {{projectEmission}} tCO₂e</b></label>

                </div>
              </div>
            </div>
          </div>

        </div>


      </div>
    </div>
    <!-- Project End -->

    <!-- leakage start-->
    <!-- <div> {{leakageParameter|json}} </div> -->
    <div *ngIf="leakageEmission != null" class="card">
      <div class="p-grid p-fluid col-sm-12">
        <div class="p-2">
          <h6>Leakage</h6>
        </div>
        <div class="row p-2">
          <div class="col-12 col-md-12">
            <div class="p-field">
              <label for="lScenario">Leakage Scenario - {{assement.lekageScenario}} </label>

            </div>
          </div>

          <!-- <div class="col-12 col-md-12">
              <div class="p-field">
                <label for="lscenarioyr">Leakage year - {{assement.assessmentYear}} </label>
               
              </div>
            </div> -->


          <div class="row p-2">
            <p-table [value]="leakageParameter">
              <ng-template pTemplate="header">
                <tr>
                  <th>
                    <div class="col-sm-2">
                    </div>
                  </th>
                  <th>Parameter</th>
                  <th>Value</th>
                  <th>Unit</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-lresult>
                <tr>
                  <td style="text-align: center">
                    <!-- <i
                          class="pi pi-eye"
                          style="font-size: 1.5rem; color: #000; margin-left: 17%"
                        ></i> -->
                  </td>
                  <td>{{ lresult.name }}</td>
                  <td>{{ lresult.value }}</td>
                  <td>{{ lresult.uomDataRequest }}</td>
                </tr>
              </ng-template>
            </p-table>

            <div class="row p-2">
              <div class="col-12 col-md-6">
                <div class="p-field">
                  <label for="lekageResult"><b> Leakage Emission : {{leakageEmission}} tCO₂e</b></label>

                </div>
              </div>
            </div>
          </div>

        </div>


      </div>
    </div>
    <!-- Project End -->

    <div *ngIf="totalEmission != null" class="card">
      <div class="p-grid p-fluid col-sm-12">
        <div class="row p-2">
          <div class="col-12 col-md-6">
            <div class="p-field">
              <label for="reduction"><b>Emission Reduction : {{totalEmission}} tCO₂e</b> </label>

            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="card" *ngIf="projectionParameter.length>0">
      <div class="p-grid p-fluid col-sm-12">
        <div class="p-2">
          <h6>Projection</h6>
        </div>
        <div class="row p-2">
          <!-- <div> {{proParameter|json}} </div> -->
          <div class="row p-2">
            <p-table [value]="projectionParameter">
              <ng-template pTemplate="header">
                <tr>
                  <th>
                    <div class="col-sm-2">
                    </div>
                  </th>
                  <th>Parameter</th>
                  <th>Value</th>
                  <th>Unit</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-proresult>
                <tr>
                  <td style="text-align: center">

                  </td>
                  <td>{{ proresult.name }}</td>
                  <td>{{ proresult.value }}</td>
                  <td>{{ proresult.uomDataRequest }}</td>
                  <!-- unit from json to be added -->
                </tr>
              </ng-template>
            </p-table>


          </div>
          <div>

          </div>
          <div class="row p-2 " style="margin: 1%">
            <!-- <div class="col-12 col-md-6"> -->
            <div class="p-field">
              <label for="contatname"><b> Projection Result</b></label>

            </div>
            <div class="row mb-3">
              <div class="col-md-12">
                <p-table #table [value]="projectionData" [responsive]="true" selectionMode="single">
                  <ng-template pTemplate="header">
                    <tr>
                      <th>Year</th>
                      <th>Baseline Result</th>
                      <th>Project Result</th>
                      <th>Leakage Result</th>
                      <th>Emission Reduction</th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-param>
                    <tr>
                      <td>{{ param.projectionYear}}</td>
                      <td>{{ param.baselineResult }} tCO₂e</td>
                      <td>{{ param.projectResult }} tCO₂e</td>
                      <td *ngIf="param.leakageResult > 0">{{ param.leakageResult }} tCO₂e</td>
                      <td *ngIf="param.leakageResult <= 0">0 tCO₂e</td>
                      <td>{{ param.emissionReduction }} tCO₂e</td>

                    </tr>
                  </ng-template>
                </p-table>
              </div>
            </div>
            <!-- </div> -->
          </div>

        </div>


      </div>
    </div>
    </div>
    <div class="row p-2">
      <div class="col-12 col-md-6">

      </div>
      <div class="col-12 col-md-2">
        <!-- <button pRipple pButton type="button" (click)="backtoPAge()"
          class="btn btn-primary btn-block text-uppercase btn-lg" style="margin-left: 1%">
            Back
        </button> -->
      </div>
      <div class="col-12 col-md-2">

        <button pRipple pButton type="button" (click)="download()"
          class="btn btn-primary btn-block text-uppercase btn-lg" style="margin-left: 1%">
            Download PDF
        </button>
      </div>

      <div class="col-12 col-md-2">

        <button pRipple pButton type="button" (click)="downloadExcel()"
          class="btn btn-primary btn-block text-uppercase btn-lg" style="margin-left: 1%">
            Download EXcel
        </button>


      </div>


    </div>



  </div>